description: >
  This jobs builds docker image.

parameters:
  image-name:
    type: string
    description: "docker image name"

  extra-build-args:
    type: string
    description: extra flags to pass to docker build
    default: ""

shell: /bin/bash --login -eo pipefail

executor: python-node

steps:
  - checkout
  - setup_remote_docker:
      version: 19.03.13
      docker_layer_caching: true
  - aws-cli/install
  - aws-ecr/ecr-login
  - docker-login
  - docker/build:
      image: << parameters.image-name >>
      extra_build_args: << parameters.extra-build-args >>
